var SEP_SPACE=0,SEP_TAB=1,SPACE_REGEXP=/\s/,TAB_REGEXP=/[\f\n\r\t\v]/,BUFFER_MAX=524288;function findregexp(c,a,d){var b=(d==0)?c.search(a):c.substr(d).search(a);return(b!=-1)?d+b:b}function findIdx(b,a,c){return b.indexOf(a,c)}function fastqaParse(){this.prev=0;this.pos=0;this.eof=false;this.last_char=0;this.start=0}fastqaParse.prototype.read=function(a){this.eof=true;this.start=0;this.end=0;return""};fastqaParse.prototype.complete=function(){return((this.prev+this.start)/this.size)*100};fastqaParse.prototype.getc=function(){if(this.start>=this.end){this.buffer=this.read(this.buffersize);if(this.end==0){return""}}return this.buffer.charAt(this.start++)};fastqaParse.prototype.getuntil=function(a,b){if(this.start>=this.end&&this.eof){return[false,"",""]}var d,c;if((typeof a!="number")){d=findIdx}else{d=findregexp;if(a==SEP_SPACE){a=SPACE_REGEXP}else{a=TAB_REGEXP}}for(;;){if(this.start>=this.end){this.buffer=this.read(this.buffersize);if(this.end==0){break}}if((c=d(this.buffer,a,this.start))!=-1){b[b.length]=this.buffer.substring(this.start,c);this.start=c+1;if(c<this.end){break}}else{b[b.length]=(this.start==0)?this.buffer:this.buffer.substr(this.start);this.start=this.end}}if(this.start<this.end){return[true,b,this.buffer[this.start-1]]}else{return[true,b,""]}};fastqaParse.prototype.findNext=function(b){var a=-1;if(this.eof){return""}if(this.start!=0&&(this.start<this.end)){a=this.buffer.substr(this.start).search(b);this.start=(a==-1)?this.end:this.start+a}while(a==-1){if(this.start>=this.end){this.buffer=this.read(this.buffersize);if(this.end==0){return""}}a=this.buffer.search(b);this.start=(a==-1)?this.end:a}return this.buffer.charAt(this.start++)};fastqaFileInput.prototype=new fastqaParse();fastqaFileInput.prototype.constructor=fastqaFileInput;function fastqaFileInput(b,a){fastqaParse.call(this);this.fileHandle=b;this.size=this.fileHandle.size;this.buffersize=Math.min(this.size,BUFFER_MAX);this.end=this.buffersize;this.reader=a;this.readfunc=(this.reader.readAsBinaryString)?function(c,d){return c.readAsBinaryString(d)}:function(c,d){return c.readAsText(d)};this.buffer=this.read(this.buffersize)}fastqaFileInput.prototype.read=function(a){if(this.pos>=this.size||this.end!=a){this.start=0;this.end=0;this.eof=true;return""}this.prev=this.pos;var b=this.readfunc(this.reader,this.fileHandle.slice(this.pos,this.pos+a));this.start=0;this.pos+=b.length;this.end=b.length;return b};fastqaTextInput.prototype=new fastqaParse();fastqaTextInput.prototype.constructor=fastqaTextInput;function fastqaTextInput(a){fastqaParse.call(this);this.size=a.length;this.buffersize=this.size;this.end=this.buffersize;this.buffer=a}function nextRecord(d){var f,b=[false,[],""],a={name:"",comment:"",qual:"",seq:""},e;if(d.last_char==0){d.last_char=d.findNext(/[>@]/);if(d.last_char==""){return[-1,a]}}b=d.getuntil(SEP_SPACE,[]);if(b[0]==false){return[-1,a]}a.name=b[1].join("");if(b[2]!="\n"){a.comment=d.getuntil("\n",[])[1].join("")}b[1]=[];while((f=d.getc())!=""&&f!=">"&&f!="+"&&f!="@"){b[1][b[1].length]=f;b=d.getuntil("\n",b[1])}a.seq=b[1].join("");d.last_char=(f==">"||f=="@")?f:0;if(f!="+"){return[a.seq.length,a]}if(d.findNext("\n")==""){return[-2,a]}b[1]=[];e=a.seq.length;do{b=d.getuntil("\n",b[1]);e-=b[1].join("").length}while(e>0&&b[0]==true);a.qual=b[1].join("");return[(a.seq.length==a.qual.length)?a.seq.length:-2,a]};